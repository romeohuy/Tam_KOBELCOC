(function(){var a="undefined"!==typeof window&&"undefined"!==typeof window.document?window.document:{},b="undefined"!==typeof module&&module.exports,c="undefined"!==typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,d=function(){for(var c,b=["requestFullscreen exitFullscreen fullscreenElement fullscreenEnabled fullscreenchange fullscreenerror".split(" "),"webkitRequestFullscreen webkitExitFullscreen webkitFullscreenElement webkitFullscreenEnabled webkitfullscreenchange webkitfullscreenerror".split(" "),
"webkitRequestFullScreen webkitCancelFullScreen webkitCurrentFullScreenElement webkitCancelFullScreen webkitfullscreenchange webkitfullscreenerror".split(" "),"mozRequestFullScreen mozCancelFullScreen mozFullScreenElement mozFullScreenEnabled mozfullscreenchange mozfullscreenerror".split(" "),"msRequestFullscreen msExitFullscreen msFullscreenElement msFullscreenEnabled MSFullscreenChange MSFullscreenError".split(" ")],d=0,f=b.length,e={};d<f;d++)if((c=b[d])&&c[1]in a){for(d=0;d<c.length;d++)e[b[0][d]]=
c[d];return e}return!1}(),e={change:d.fullscreenchange,error:d.fullscreenerror},f={request:function(b){var g=d.requestFullscreen;b=b||a.documentElement;if(/5\.1[.\d]* Safari/.test(navigator.userAgent))b[g]();else b[g](c&&Element.ALLOW_KEYBOARD_INPUT)},exit:function(){a[d.exitFullscreen]()},toggle:function(a){this.isFullscreen?this.exit():this.request(a)},onchange:function(a){this.on("change",a)},onerror:function(a){this.on("error",a)},on:function(c,b){var g=e[c];g&&a.addEventListener(g,b,!1)},off:function(c,
b){var g=e[c];g&&a.removeEventListener(g,b,!1)},raw:d};d?(Object.defineProperties(f,{isFullscreen:{get:function(){return!!a[d.fullscreenElement]}},element:{enumerable:!0,get:function(){return a[d.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return!!a[d.fullscreenEnabled]}}}),b?module.exports=f:window.screenfull=f):b?module.exports=!1:window.screenfull=!1})();var s_iScaleFactor=1,s_iOffsetX,s_iOffsetY,s_bIsIphone=!1;
(function(a){(jQuery.browser=jQuery.browser||{}).mobile=/android|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(ad|hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|tablet|treo|up\.(browser|link)|vodafone|wap|webos|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(a.substr(0,
4))})(navigator.userAgent||navigator.vendor||window.opera);$(window).resize(function(){sizeHandler()});function trace(a){console.log(a)}function hexToRgb(a){return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null}function checkIfiOS(){return navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?!0:!1}
function getSize(a){var b=a.toLowerCase(),c=window.document,d=c.documentElement;if(void 0===window["inner"+a])a=d["client"+a];else if(window["inner"+a]!=d["client"+a]){var e=c.createElement("body");e.id="vpw-test-b";e.style.cssText="overflow:scroll";var f=c.createElement("div");f.id="vpw-test-d";f.style.cssText="position:absolute;top:-1000px";f.innerHTML="<style>@media("+b+":"+d["client"+a]+"px){body#vpw-test-b div#vpw-test-d{"+b+":7px!important}}</style>";e.appendChild(f);d.insertBefore(e,c.head);
a=7==f["offset"+a]?d["client"+a]:window["inner"+a];d.removeChild(e)}else a=window["inner"+a];return a}window.addEventListener("orientationchange",onOrientationChange);function onOrientationChange(){window.matchMedia("(orientation: portrait)").matches&&sizeHandler();window.matchMedia("(orientation: landscape)").matches&&sizeHandler()}
function isIOS(){var a="iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";");for(-1!==navigator.userAgent.toLowerCase().indexOf("iphone")&&(s_bIsIphone=!0);a.length;)if(navigator.platform===a.pop())return!0;return s_bIsIphone=!1}function getIOSWindowHeight(){return document.documentElement.clientWidth/window.innerWidth*window.innerHeight}function getHeightOfIOSToolbars(){var a=(0===window.orientation?screen.height:screen.width)-getIOSWindowHeight();return 1<a?a:0}
function sizeHandler(){window.scrollTo(0,1);if($("#canvas")){var a=navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?getIOSWindowHeight():getSize("Height");var b=getSize("Width");_checkOrientation(b,a);var c=Math.min(a/CANVAS_HEIGHT,b/CANVAS_WIDTH),d=CANVAS_WIDTH*c;c*=CANVAS_HEIGHT;if(c<a){var e=a-c;c+=e;d+=CANVAS_WIDTH/CANVAS_HEIGHT*e}else d<b&&(e=b-d,d+=e,c+=CANVAS_HEIGHT/CANVAS_WIDTH*e);e=a/2-c/2;var f=b/2-d/2,g=CANVAS_WIDTH/d;if(f*g<-EDGEBOARD_X||e*g<-EDGEBOARD_Y)c=Math.min(a/(CANVAS_HEIGHT-2*
EDGEBOARD_Y),b/(CANVAS_WIDTH-2*EDGEBOARD_X)),d=CANVAS_WIDTH*c,c*=CANVAS_HEIGHT,e=(a-c)/2,f=(b-d)/2,g=CANVAS_WIDTH/d;s_iOffsetX=-1*f*g;s_iOffsetY=-1*e*g;0<=e&&(s_iOffsetY=0);0<=f&&(s_iOffsetX=0);null!==s_oInterface&&s_oInterface.refreshButtonPos(s_iOffsetX,s_iOffsetY);null!==s_oMenu&&s_oMenu.refreshButtonPos(s_iOffsetX,s_iOffsetY);null!==s_oModeMenu&&s_oModeMenu.refreshButtonPos(s_iOffsetX,s_iOffsetY);$("#canvas").css("width",d+"px");$("#canvas").css("height",c+"px");0>e?$("#canvas").css("top",e+"px"):
$("#canvas").css("top","0px");$("#canvas").css("left",f+"px");$("#draw_canvas").css("width",d+"px");$("#draw_canvas").css("height",c+"px");0>e?$("#draw_canvas").css("top",e+"px"):$("#draw_canvas").css("top","0px");$("#draw_canvas").css("left",f+"px");$("#interactivecanvas").css("width",d+"px");$("#interactivecanvas").css("height",c+"px");0>e?$("#interactivecanvas").css("top",e+"px"):$("#interactivecanvas").css("top","0px");$("#interactivecanvas").css("left",f+"px");s_oCanvasLeft=$("#canvas").offset().left;
s_oCanvasTop=$("#canvas").offset().top}}
function _checkOrientation(a,b){s_bMobile&&ENABLE_CHECK_ORIENTATION&&(a>b?"landscape"===$(".orientation-msg-container").attr("data-orientation")?($(".orientation-msg-container").css("display","none"),s_oMain.startUpdate()):($(".orientation-msg-container").css("display","block"),s_oMain.stopUpdate()):"portrait"===$(".orientation-msg-container").attr("data-orientation")?($(".orientation-msg-container").css("display","none"),s_oMain.startUpdate()):($(".orientation-msg-container").css("display","block"),
s_oMain.stopUpdate()))}function playSound(a,b,c){return!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(s_aSounds[a].play(),s_aSounds[a].volume(b),s_aSounds[a].loop(c),s_aSounds[a]):null}function stopSound(a){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||a.stop()}function setVolume(a,b){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||a.volume(b)}function setMute(a,b){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||a.mute(b)}function fadeSound(a,b,c,d){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||a.fade(b,c,d)}
function soundPlaying(a){if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)return a.playing()}function createBitmap(a,b,c){var d=new createjs.Bitmap(a),e=new createjs.Graphics;b&&c?e.beginFill("#fff").drawRect(0,0,b,c):e.beginFill("#ff0").drawRect(0,0,a.width,a.height);a=new createjs.Shape(e);d.hitArea=a;return d}
function createSprite(a,b,c,d,e,f){a=null!==b?new createjs.Sprite(a,b):new createjs.Sprite(a);b=new createjs.Graphics;b.beginFill("#000000").drawRect(-c,-d,e,f);c=new createjs.Shape(b);a.hitArea=c;return a}function pad(a,b,c){a+="";return a.length>=b?a:Array(b-a.length+1).join(c||"0")+a}function randomFloatBetween(a,b,c){"undefined"===typeof c&&(c=2);return parseFloat(Math.min(a+Math.random()*(b-a),b).toFixed(c))}
function rotateVector2D(a,b){var c=b.getX()*Math.cos(a)+b.getY()*Math.sin(a),d=b.getX()*-Math.sin(a)+b.getY()*Math.cos(a);b.set(c,d)}function tweenVectorsOnX(a,b,c){return a+c*(b-a)}function shuffle(a){for(var b=a.length,c,d;0!==b;)d=Math.floor(Math.random()*b),--b,c=a[b],a[b]=a[d],a[d]=c;return a}function bubbleSort(a){do{var b=!1;for(var c=0;c<a.length-1;c++)a[c]>a[c+1]&&(b=a[c],a[c]=a[c+1],a[c+1]=b,b=!0)}while(b)}function compare(a,b){return a.index>b.index?-1:a.index<b.index?1:0}
function easeLinear(a,b,c,d){return c*a/d+b}function easeInQuad(a,b,c,d){return c*(a/=d)*a+b}function easeInSine(a,b,c,d){return-c*Math.cos(a/d*(Math.PI/2))+c+b}function easeInCubic(a,b,c,d){return c*(a/=d)*a*a+b}function getTrajectoryPoint(a,b){var c=new createjs.Point,d=(1-a)*(1-a),e=a*a;c.x=d*b.start.x+2*(1-a)*a*b.traj.x+e*b.end.x;c.y=d*b.start.y+2*(1-a)*a*b.traj.y+e*b.end.y;return c}
function formatTime(a){a/=1E3;var b=Math.floor(a/60);a=parseFloat(a-60*b).toFixed(1);var c="";c=10>b?c+("0"+b+":"):c+(b+":");return 10>a?c+("0"+a):c+a}function degreesToRadians(a){return a*Math.PI/180}function checkRectCollision(a,b){var c=getBounds(a,.9);var d=getBounds(b,.98);return calculateIntersection(c,d)}
function calculateIntersection(a,b){var c,d,e,f;var g=a.x+(c=a.width/2);var h=a.y+(d=a.height/2);var p=b.x+(e=b.width/2);var k=b.y+(f=b.height/2);g=Math.abs(g-p)-(c+e);h=Math.abs(h-k)-(d+f);return 0>g&&0>h?(g=Math.min(Math.min(a.width,b.width),-g),h=Math.min(Math.min(a.height,b.height),-h),{x:Math.max(a.x,b.x),y:Math.max(a.y,b.y),width:g,height:h,rect1:a,rect2:b}):null}
function getBounds(a,b){var c={x:Infinity,y:Infinity,width:0,height:0};if(a instanceof createjs.Container){c.x2=-Infinity;c.y2=-Infinity;var d=a.children,e=d.length,f;for(f=0;f<e;f++){var g=getBounds(d[f],1);g.x<c.x&&(c.x=g.x);g.y<c.y&&(c.y=g.y);g.x+g.width>c.x2&&(c.x2=g.x+g.width);g.y+g.height>c.y2&&(c.y2=g.y+g.height)}Infinity==c.x&&(c.x=0);Infinity==c.y&&(c.y=0);Infinity==c.x2&&(c.x2=0);Infinity==c.y2&&(c.y2=0);c.width=c.x2-c.x;c.height=c.y2-c.y;delete c.x2;delete c.y2}else{if(a instanceof createjs.Bitmap){e=
a.sourceRect||a.image;f=e.width*b;var h=e.height*b}else if(a instanceof createjs.Sprite)if(a.spriteSheet._frames&&a.spriteSheet._frames[a.currentFrame]&&a.spriteSheet._frames[a.currentFrame].image){e=a.spriteSheet.getFrame(a.currentFrame);f=e.rect.width;h=e.rect.height;d=e.regX;var p=e.regY}else c.x=a.x||0,c.y=a.y||0;else c.x=a.x||0,c.y=a.y||0;d=d||0;f=f||0;p=p||0;h=h||0;c.regX=d;c.regY=p;e=a.localToGlobal(0-d,0-p);g=a.localToGlobal(f-d,h-p);f=a.localToGlobal(f-d,0-p);d=a.localToGlobal(0-d,h-p);c.x=
Math.min(Math.min(Math.min(e.x,g.x),f.x),d.x);c.y=Math.min(Math.min(Math.min(e.y,g.y),f.y),d.y);c.width=Math.max(Math.max(Math.max(e.x,g.x),f.x),d.x)-c.x;c.height=Math.max(Math.max(Math.max(e.y,g.y),f.y),d.y)-c.y}return c}function NoClickDelay(a){this.element=a;window.Touch&&this.element.addEventListener("touchstart",this,!1)}
NoClickDelay.prototype={handleEvent:function(a){switch(a.type){case "touchstart":this.onTouchStart(a);break;case "touchmove":this.onTouchMove(a);break;case "touchend":this.onTouchEnd(a)}},onTouchStart:function(a){a.preventDefault();this.moved=!1;this.element.addEventListener("touchmove",this,!1);this.element.addEventListener("touchend",this,!1)},onTouchMove:function(a){this.moved=!0},onTouchEnd:function(a){this.element.removeEventListener("touchmove",this,!1);this.element.removeEventListener("touchend",
this,!1);if(!this.moved){a=document.elementFromPoint(a.changedTouches[0].clientX,a.changedTouches[0].clientY);3==a.nodeType&&(a=a.parentNode);var b=document.createEvent("MouseEvents");b.initEvent("click",!0,!0);a.dispatchEvent(b)}}};
(function(){function a(a){var c={focus:"visible",focusin:"visible",pageshow:"visible",blur:"hidden",focusout:"hidden",pagehide:"hidden"};a=a||window.event;a.type in c?document.body.className=c[a.type]:(document.body.className=this[b]?"hidden":"visible","hidden"===document.body.className?s_oMain.stopUpdate():s_oMain.startUpdate())}var b="hidden";b in document?document.addEventListener("visibilitychange",a):(b="mozHidden")in document?document.addEventListener("mozvisibilitychange",a):(b="webkitHidden")in
document?document.addEventListener("webkitvisibilitychange",a):(b="msHidden")in document?document.addEventListener("msvisibilitychange",a):"onfocusin"in document?document.onfocusin=document.onfocusout=a:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=a})();function ctlArcadeResume(){null!==s_oMain&&s_oMain.startUpdate()}function ctlArcadePause(){null!==s_oMain&&s_oMain.stopUpdate()}
function getParamValue(a){for(var b=window.location.search.substring(1).split("&"),c=0;c<b.length;c++){var d=b[c].split("=");if(d[0]==a)return d[1]}}function fullscreenHandler(){ENABLE_FULLSCREEN&&screenfull.enabled&&(s_bFullscreen=screen.height<window.innerHeight+3&&screen.height>window.innerHeight-3?!0:!1,null!==s_oInterface&&s_oInterface.resetFullscreenBut(),null!==s_oModeMenu&&s_oModeMenu.resetFullscreenBut(),null!==s_oMenu&&s_oMenu.resetFullscreenBut())}
if(screenfull.enabled)screenfull.on("change",function(){s_bFullscreen=screenfull.isFullscreen;null!==s_oInterface&&s_oInterface.resetFullscreenBut();null!==s_oModeMenu&&s_oModeMenu.resetFullscreenBut();null!==s_oMenu&&s_oMenu.resetFullscreenBut()});
function CSpriteLibrary(){var a,b,c,d,e,f;this.init=function(g,h,p){c=b=0;d=g;e=h;f=p;a={}};this.addSprite=function(c,d){a.hasOwnProperty(c)||(a[c]={szPath:d,oSprite:new Image},b++)};this.getSprite=function(c){return a.hasOwnProperty(c)?a[c].oSprite:null};this._onSpritesLoaded=function(){e.call(f)};this._onSpriteLoaded=function(){d.call(f);++c==b&&this._onSpritesLoaded()};this.loadSprites=function(){for(var c in a)a[c].oSprite.oSpriteLibrary=this,a[c].oSprite.onload=function(){this.oSpriteLibrary._onSpriteLoaded()},
a[c].oSprite.src=a[c].szPath};this.getNumSprites=function(){return b}}var CANVAS_WIDTH=1920,CANVAS_HEIGHT=1080,EDGEBOARD_X=200,EDGEBOARD_Y=35,FPS=30,FPS_TIME=1E3/FPS,DISABLE_SOUND_MOBILE=!1,PRIMARY_FONT="walibi",SECONDARY_FONT="Arial",STATE_LOADING=0,STATE_MENU=1,STATE_HELP=1,STATE_GAME=3,ON_MOUSE_DOWN=0,ON_MOUSE_UP=1,ON_MOUSE_OVER=2,ON_MOUSE_OUT=3,ON_DRAG_START=4,ON_DRAG_END=5,COLORS=[],MIN_STROKE,MAX_STROKE,AD_SHOW_COUNTER;TEXT_PLAY="PLAY";TEXT_HELP1="PLEASE, PICK A COLOR";TEXT_CHOOSE="SELECT THE PICTURE YOU WANT TO PAINT";
function CPreloader() {
    var a, b, c, d, e, f, g; this._init = function () { s_oSpriteLibrary.init(this._onImagesLoaded, this._onAllImagesLoaded, this); s_oSpriteLibrary.addSprite("bg_menu", "/Frontend/activitybook/coloring/sprites/bg_menu.jpg"); s_oSpriteLibrary.addSprite("progress_bar","/Frontend/activitybook/coloring/sprites/progress_bar.png");s_oSpriteLibrary.loadSprites();g=new createjs.Container;s_oStage.addChild(g)};this.unload=function(){g.removeAllChildren()};this.hide=function(){var a=this;setTimeout(function(){createjs.Tween.get(f).to({alpha:1},500).call(function(){a.unload();
s_oMain.gotoMenu()})},1E3)};this._onImagesLoaded=function(){};this._onAllImagesLoaded=function(){this.attachSprites();s_oMain.preloaderReady()};this.attachSprites=function(){var h=createBitmap(s_oSpriteLibrary.getSprite("bg_menu"));g.addChild(h);h=s_oSpriteLibrary.getSprite("progress_bar");d=createBitmap(h);d.x=CANVAS_WIDTH/2-h.width/2;d.y=CANVAS_HEIGHT-170;g.addChild(d);a=h.width;b=h.height;e=new createjs.Shape;e.graphics.beginFill("rgba(255,255,255,0.01)").drawRect(d.x,d.y,1,b);g.addChild(e);d.mask=
e;c=new createjs.Text("","30px "+SECONDARY_FONT,"#fff");c.x=CANVAS_WIDTH/2;c.y=CANVAS_HEIGHT-125;c.shadow=new createjs.Shadow("#000",2,2,2);c.textBaseline="alphabetic";c.textAlign="center";g.addChild(c);f=new createjs.Shape;f.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);f.alpha=0;g.addChild(f)};this.refreshLoader=function(g){c.text=g+"%";e.graphics.clear();g=Math.floor(g*a/100);e.graphics.beginFill("rgba(255,255,255,0.01)").drawRect(d.x,d.y,g,b)};this._init()}
function CMain(a){var b,c=0,d=0,e;this.initContainer=function(){s_oDrawCanvas=document.getElementById("draw_canvas");s_oDrawStage=new createjs.Stage(s_oDrawCanvas);s_oCanvas=document.getElementById("canvas");s_oStage=new createjs.Stage(s_oCanvas);s_oInteractiveCanvas=document.getElementById("interactivecanvas");s_oInteractiveStage=new createjs.Stage(s_oInteractiveCanvas);createjs.Touch.enable(s_oInteractiveStage);s_bMobile=jQuery.browser.mobile;!1===s_bMobile&&(s_oStage.enableMouseOver(FPS),s_oInteractiveStage.enableMouseOver(FPS),
$("body").on("contextmenu","#canvas",function(a){return!1}));s_iPrevTime=(new Date).getTime();createjs.Ticker.addEventListener("tick",this._update);createjs.Ticker.setFPS(FPS);navigator.userAgent.match(/Windows Phone/i)&&(DISABLE_SOUND_MOBILE=!0);s_oSpriteLibrary=new CSpriteLibrary;e=new CPreloader};this.preloaderReady=function(){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||this._initSounds();this._loadImages();b=!0};this.soundLoaded=function(){c++;e.refreshLoader(Math.floor(c/d*100));c===d&&s_oMain._onAllResourcesLoaded()};
    this._initSounds = function () { var a = []; a.push({ path: "/Frontend/activitybook/coloring/sounds/", filename: "soundtrack", loop: !0, volume: 1, ingamename: "soundtrack" }); a.push({ path:"/Frontend/activitybook/coloring/sounds/",filename:"press_button",loop:!1,volume:1,ingamename:"click"});d+=a.length;s_aSounds=[];for(var c=0;c<a.length;c++)s_aSounds[a[c].ingamename]=new Howl({src:[a[c].path+a[c].filename+".mp3",a[c].path+a[c].filename+".ogg"],autoplay:!1,preload:!0,loop:a[c].loop,volume:a[c].volume,onload:s_oMain.soundLoaded})};this._loadImages=function(){s_oSpriteLibrary.init(this._onImagesLoaded, this._onAllImagesLoaded, this); s_oSpriteLibrary.addSprite("but_play", "/Frontend/activitybook/coloring/sprites/but_play.png"); s_oSpriteLibrary.addSprite("ctl_logo", "/Frontend/activitybook/coloring/sprites/ctl_logo.png"); s_oSpriteLibrary.addSprite("but_fullscreen", "/Frontend/activitybook/coloring/sprites/but_fullscreen.png"); s_oSpriteLibrary.addSprite("but_credits", "/Frontend/activitybook/coloring/sprites/but_credits.png"); s_oSpriteLibrary.addSprite("msg_box", "/Frontend/activitybook/coloring/sprites/msg_box.png"); s_oSpriteLibrary.addSprite("bg_menu", "/Frontend/activitybook/coloring/sprites/bg_menu.jpg"); s_oSpriteLibrary.addSprite("bg_modemenu","/Frontend/activitybook/coloring/sprites/bg_modemenu.jpg");s_oSpriteLibrary.addSprite("bg_game","/Frontend/activitybook/coloring/sprites/bg_game.jpg"); s_oSpriteLibrary.addSprite("but_exit", "/Frontend/activitybook/coloring/sprites/but_exit.png"); s_oSpriteLibrary.addSprite("audio_icon", "/Frontend/activitybook/coloring/sprites/audio_icon.png"); s_oSpriteLibrary.addSprite("but_save", "/Frontend/activitybook/coloring/sprites/but_save.png"); s_oSpriteLibrary.addSprite("but_print", "/Frontend/activitybook/coloring/sprites/but_print.png"); s_oSpriteLibrary.addSprite("but_restart", "/Frontend/activitybook/coloring/sprites/but_restart.png"); s_oSpriteLibrary.addSprite("eraser", "/Frontend/activitybook/coloring/sprites/eraser.png"); s_oSpriteLibrary.addSprite("sliderbox","/Frontend/activitybook/coloring/sprites/sliderbox.png");s_oSpriteLibrary.addSprite("slider","/Frontend/activitybook/coloring/sprites/slider.png"); s_oSpriteLibrary.addSprite("pen", "/Frontend/activitybook/coloring/sprites/pen.png"); s_oSpriteLibrary.addSprite("canvas_drawing", "/Frontend/activitybook/coloring/sprites/drawcanvas.jpg"); s_oSpriteLibrary.addSprite("drawcanvas_frame", "/Frontend/activitybook/coloring/sprites/drawcanvas_frame.png"); s_oSpriteLibrary.addSprite("image1", "/Frontend/activitybook/coloring/sprites/image1.png"); s_oSpriteLibrary.addSprite("image2", "/Frontend/activitybook/coloring/sprites/image2.png"); s_oSpriteLibrary.addSprite("image3", "/Frontend/activitybook/coloring/sprites/image3.png"); s_oSpriteLibrary.addSprite("image4","/Frontend/activitybook/coloring/sprites/image4.png");s_oSpriteLibrary.addSprite("image5","/Frontend/activitybook/coloring/sprites/image5.png"); s_oSpriteLibrary.addSprite("image6","/Frontend/activitybook/coloring/sprites/image6.png");d+=s_oSpriteLibrary.getNumSprites();s_oSpriteLibrary.loadSprites()};this._onImagesLoaded=function(){c++;e.refreshLoader(Math.floor(c/d*100));c===d&&s_oMain._onAllResourcesLoaded()};this._onAllImagesLoaded=function(){};this.onAllPreloaderImagesLoaded=function(){this._loadImages()};this._onAllResourcesLoaded=function(){e.unload();isIOS()||playSound("soundtrack",1,!0);this.gotoMenu()};this.gotoMenu=function(){new CMenu};
this.gotoModeMenu=function(){new CModeMenu};this.gotoGame=function(a){s_szCurDraw=a;new CGame(f)};this.gotoHelp=function(){new CHelp};this.stopUpdate=function(){b=!1;createjs.Ticker.paused=!0;$("#block_game").css("display","block");Howler.mute(!0)};this.startUpdate=function(){s_iPrevTime=(new Date).getTime();b=!0;createjs.Ticker.paused=!1;$("#block_game").css("display","none");s_bAudioActive&&Howler.mute(!1)};this._update=function(){if(!1!==b){var a=(new Date).getTime();s_iTimeElaps=a-s_iPrevTime;
s_iCntTime+=s_iTimeElaps;s_iCntFps++;s_iPrevTime=a;1E3<=s_iCntTime&&(s_iCurFps=s_iCntFps,s_iCntTime-=1E3,s_iCntFps=0)}};ENABLE_FULLSCREEN=a.fullscreen;ENABLE_CHECK_ORIENTATION=a.check_orientation;s_oMain=this;var f=a;this.initContainer()}
var s_bMobile,s_bAudioActive=!0,s_iCntTime=0,s_iTimeElaps=0,s_iPrevTime=0,s_iCntFps=0,s_iCurFps=0,s_szCurDraw,s_bFullscreen=!1,s_oStage,s_oMain,s_oSpriteLibrary,s_oSoundTrack,s_oCanvas,s_oDrawCanvas,s_oDrawStage,s_oInteractiveCanvas,s_oInteractiveStage,s_aSounds=[];
function CTextButton(a,b,c,d,e,f,g){var h,p,k,v,u;this._init=function(a,c,b,d,g,f,e){h=[];p=[];var m=createBitmap(b),l=Math.ceil(e/20);u=new createjs.Text(d," "+e+"px "+g,"#ff4200");u.textAlign="center";u.textBaseline="alphabetic";var w=u.getBounds();u.x=b.width/2+l;u.y=Math.floor(b.height/2)+w.height/3+l;v=new createjs.Text(d," "+e+"px "+g,f);v.textAlign="center";v.textBaseline="alphabetic";w=v.getBounds();v.x=b.width/2;v.y=Math.floor(b.height/2)+w.height/3;k=new createjs.Container;k.x=a;k.y=c;k.regX=
b.width/2;k.regY=b.height/2;k.cursor="pointer";k.addChild(m,u,v);s_oInteractiveStage.addChild(k);s_oInteractiveStage.update();this._initListener()};this.unload=function(){k.off("mousedown");k.off("pressup");s_oInteractiveStage.removeChild(k)};this.setVisible=function(a){k.visible=a};this._initListener=function(){k.on("mousedown",this.buttonDown);k.on("pressup",this.buttonRelease)};this.addEventListener=function(a,c,b){h[a]=c;p[a]=b};this.buttonRelease=function(){k.scaleX=1;k.scaleY=1;h[ON_MOUSE_UP]&&
h[ON_MOUSE_UP].call(p[ON_MOUSE_UP]);s_oInteractiveStage.update()};this.buttonDown=function(){k.scaleX=.9;k.scaleY=.9;playSound("click",1,!1);h[ON_MOUSE_DOWN]&&h[ON_MOUSE_DOWN].call(p[ON_MOUSE_DOWN]);s_oInteractiveStage.update()};this.setTextPosition=function(a){v.y=a;u.y=a+2};this.setPosition=function(a,c){k.x=a;k.y=c};this.setX=function(a){k.x=a};this.setY=function(a){k.y=a};this.getButtonImage=function(){return k};this.getX=function(){return k.x};this.getY=function(){return k.y};this._init(a,b,
c,d,e,f,g);return this}
function CToggle(a,b,c,d){var e,f,g,h;this._init=function(a,c,b,d){f=[];g=[];var k=new createjs.SpriteSheet({images:[b],frames:{width:b.width/2,height:b.height,regX:b.width/2/2,regY:b.height/2},animations:{state_true:[0],state_false:[1]}});e=d;h=createSprite(k,"state_"+e,b.width/2/2,b.height/2,b.width/2,b.height);h.x=a;h.y=c;h.cursor="pointer";h.stop();s_oInteractiveStage.addChild(h);this._initListener()};this.unload=function(){h.off("mousedown",this.buttonDown);h.off("pressup",this.buttonRelease);
s_oInteractiveStage.removeChild(h)};this._initListener=function(){h.on("mousedown",this.buttonDown);h.on("pressup",this.buttonRelease)};this.addEventListener=function(a,c,b){f[a]=c;g[a]=b};this.setActive=function(a){e=a;h.gotoAndStop("state_"+e)};this.buttonRelease=function(){h.scaleX=1;h.scaleY=1;e=!e;h.gotoAndStop("state_"+e);f[ON_MOUSE_UP]&&f[ON_MOUSE_UP].call(g[ON_MOUSE_UP],e);s_oInteractiveStage.update()};this.buttonDown=function(){h.scaleX=.9;h.scaleY=.9;playSound("click",1,!1);f[ON_MOUSE_DOWN]&&
f[ON_MOUSE_DOWN].call(g[ON_MOUSE_DOWN]);s_oInteractiveStage.update()};this.setPosition=function(a,c){h.x=a;h.y=c};this._init(a,b,c,d)}
function CSliderBox(a,b,c,d){var e,f=!1,g,h,p;this._init=function(a,c,b,d){e=!1;g=new createjs.Container;g.x=a;g.y=c;g.cursor="pointer";d.addChild(g);a=new createjs.SpriteSheet({images:[b],frames:{width:b.width/2,height:b.height,regX:b.width/2/2,regY:b.height/2},animations:{state_true:[0],state_false:[1]}});h=createSprite(a,"state_"+f,b.width/2/2,b.height/2,b.width/2,b.height);p=new createjs.Shape;p.graphics.beginFill("white").drawCircle(0,0,.5*s_oInterface.getStroke());g.addChild(h,p);this._initListener()};
this.unload=function(){g.off("mousedown",this.buttonDown);g.off("pressup",this.buttonRelease);d.removeChild(g)};this.setVisible=function(a){g.visible=a};this.setSliderVisible=function(a){e=a};this.setCircle=function(a,c){p.graphics.clear();null===c&&(c="#FFFFFF");p.graphics.beginFill(c).drawCircle(0,0,.5*a)};this._initListener=function(){g.on("mousedown",this.buttonDown);g.on("pressup",this.buttonRelease)};this.buttonRelease=function(){g.scaleX=1;g.scaleY=1;e=!e;s_oInterface.setSliderVisible(e);e||
s_oGame.setTempColor();f=!f;h.gotoAndStop("state_"+f);s_oInteractiveStage.update()};this.buttonDown=function(){g.scaleX=.9;g.scaleY=.9;e||s_oGame.saveTempColor();playSound("click",1,!1);s_oInterface.disableStroke();s_oInteractiveStage.update()};this.setPosition=function(a,c){g.x=a;g.y=c};this.setX=function(a){g.x=a};this.setY=function(a){g.y=a};this.getButtonImage=function(){return g};this.getX=function(){return g.x};this.getY=function(){return g.y};this.setActive=function(a){(f=a)||h.gotoAndStop("state_"+
f)};this._init(a,b,c,d);return this}
function CSlider(a,b,c,d,e,f){var g,h,p,k,v,u,w,l;this._init=function(a,c,b,d,e,f){g=Math.round((e-d)/2);l=new createjs.Container;l.x=a;l.y=c;f.addChild(l);a=new createjs.SpriteSheet({images:[b],frames:{width:b.width/3,height:b.height,regX:b.width/3/2,regY:b.height/2},animations:{pointer:[0],bar:[1],label:[2]}});v=createSprite(a,"bar",b.width/3/2,b.height/2,b.width/3,b.height);v.stop();l.addChild(v);u=createSprite(a,"label",b.width/3/2,b.height/2,b.width/3,b.height);u.stop();u.y=-b.height/2-b.width/
3/2;l.addChild(u);w=new createjs.Text(g," 24px "+PRIMARY_FONT,"#ffffff");w.y=-b.height/2-b.width/3/2;w.textAlign="center";w.textBaseline="middle";w.lineWidth=280;l.addChild(w);k=createSprite(a,"pointer",b.width/3/2,b.height/2,b.width/3,b.height);k.stop();l.addChild(k);p=b.height/2-b.width/3/2;h=-b.height/2+b.width/3/2;l.visible=!1;this._initListener()};this.unload=function(){k.off("pressmove",this.buttonDown);k.off("pressup",this.buttonRelease);f.removeChild(l)};this._initListener=function(){k.on("pressmove",
this.buttonDown);k.on("pressup",this.buttonRelease)};this.buttonRelease=function(){s_oGame.sliderMoving(!1);s_oInterface.setSliderVisible(!1);s_oInterface.setStroke(g);s_oInterface.restartStroke();s_oInteractiveStage.update()};this.buttonDown=function(a){s_oGame.sliderMoving(!0);a=l.globalToLocal(a.stageX,a.stageY);k.y=a.y;a.y>p?k.y=p:a.y<h&&(k.y=h);x.setValue();w.text=g;s_oInterface.setCircleImage(g,s_oGame.getTempColor());s_oInteractiveStage.update()};this.setValue=function(){g=(k.y-p)/(h-p)*(e-
d)+d;g=Math.round(g)};this.getValue=function(){return g};this.setLabel=function(){};this.setPosition=function(a,b){k.x=a;k.y=b};this.setVisible=function(a){l.visible=a;s_oInteractiveStage.update()};this.getVisible=function(){return l.visible};var x=this;this._init(a,b,c,d,e,f)}
function CGfxButton(a,b,c){var d,e,f;this._init=function(a,b,c){d=[];e=[];f=createBitmap(c);f.x=a;f.y=b;f.regX=c.width/2;f.regY=c.height/2;f.cursor="pointer";s_oInteractiveStage.addChild(f);s_oInteractiveStage.update();this._initListener()};this.unload=function(){f.off("mousedown",this.buttonDown);f.off("pressup",this.buttonRelease);s_oInteractiveStage.removeChild(f)};this.setVisible=function(a){f.visible=a};this._initListener=function(){f.on("mousedown",this.buttonDown);f.on("pressup",this.buttonRelease)};
this.addEventListener=function(a,b,c){d[a]=b;e[a]=c};this.buttonRelease=function(){f.scaleX=1;f.scaleY=1;d[ON_MOUSE_UP]&&d[ON_MOUSE_UP].call(e[ON_MOUSE_UP]);s_oInteractiveStage.update()};this.buttonDown=function(){f.scaleX=.9;f.scaleY=.9;playSound("click",1,!1);d[ON_MOUSE_DOWN]&&d[ON_MOUSE_DOWN].call(e[ON_MOUSE_DOWN]);s_oInteractiveStage.update()};this.setPosition=function(a,b){f.x=a;f.y=b};this.setX=function(a){f.x=a};this.setY=function(a){f.y=a};this.getButtonImage=function(){return f};this.getX=
function(){return f.x};this.getY=function(){return f.y};this._init(a,b,c);return this}
function CMenu(){var a,b,c,d,e,f,g,h,p,k,v,u=null,w=null;this._init=function(){g=createBitmap(s_oSpriteLibrary.getSprite("bg_menu"));s_oInteractiveStage.addChild(g);var l=s_oSpriteLibrary.getSprite("but_play");h=new CTextButton(CANVAS_WIDTH/2,CANVAS_HEIGHT-200,l,TEXT_PLAY,"walibi","#eedc20",80);h.addEventListener(ON_MOUSE_UP,this._onButPlayRelease,this);if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)l=s_oSpriteLibrary.getSprite("audio_icon"),e=CANVAS_WIDTH-l.height/2-10,f=l.height/2+10,p=new CToggle(e,
f,l,s_bAudioActive),p.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this);l=s_oSpriteLibrary.getSprite("but_credits");c=l.width/2+12;d=l.height/2+16;k=new CGfxButton(c,d,l,s_oInteractiveStage);k.addEventListener(ON_MOUSE_UP,this._onCreditsBut,this);l=window.document;var x=l.documentElement;u=x.requestFullscreen||x.mozRequestFullScreen||x.webkitRequestFullScreen||x.msRequestFullscreen;w=l.exitFullscreen||l.mozCancelFullScreen||l.webkitExitFullscreen||l.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(u=
!1);u&&screenfull.enabled&&(l=s_oSpriteLibrary.getSprite("but_fullscreen"),a=c+l.width/2+12,b=l.height/2+16,v=new CToggle(a,b,l,s_bFullscreen,s_oInteractiveStage),v.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this));this.refreshButtonPos(s_iOffsetX,s_iOffsetY)};this.unload=function(){h.unload();h=null;k.unload();if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)p.unload(),p=null;u&&screenfull.enabled&&v.unload();s_oInteractiveStage.removeChild(g);s_oMenu=g=null};this.refreshButtonPos=function(g,
h){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||p.setPosition(e-g,h+f);k.setPosition(c+g,h+d);u&&screenfull.enabled&&v.setPosition(a+g,b+h);setTimeout(function(){s_oInteractiveStage.update()},300)};this.resetFullscreenBut=function(){u&&screenfull.enabled&&v.setActive(s_bFullscreen)};this._onFullscreenRelease=function(){s_bFullscreen?w.call(window.document):u.call(window.document.documentElement);sizeHandler()};this._onCreditsBut=function(){new CCreditsPanel};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);
s_bAudioActive=!s_bAudioActive};this._onButPlayRelease=function(){this.unload();isIOS()&&!soundPlaying(s_aSounds.soundtrack)&&playSound("soundtrack",1,!0);$(s_oMain).trigger("start_session");s_oMain.gotoModeMenu()};s_oMenu=this;this._init()}var s_oMenu=null;
function CModeMenu(){var a,b,c,d,e,f,g,h,p,k,v,u,w,l,x,y=null,A=null;this._init=function(){e=createBitmap(s_oSpriteLibrary.getSprite("bg_modemenu"));g=new createjs.Text(TEXT_CHOOSE," 60px "+PRIMARY_FONT,"#ff4200");g.x=CANVAS_WIDTH/2;g.y=CANVAS_HEIGHT/2+30;g.textAlign="center";g.textBaseline="middle";g.lineWidth=1700;g.outline=10;f=new createjs.Text(TEXT_CHOOSE," 60px "+PRIMARY_FONT,"#eedc20");f.x=CANVAS_WIDTH/2;f.y=CANVAS_HEIGHT/2+30;f.textAlign="center";f.textBaseline="middle";f.lineWidth=1700;k=
new createjs.Container;k.x=CANVAS_WIDTH/2-500;k.y=CANVAS_HEIGHT/2-190;k.scaleX=.3;k.scaleY=.3;k.cursor="pointer";k.on("click",this._onImageClicked,this,!1,"image1");var m=s_oSpriteLibrary.getSprite("image1"),r=m.width,q=m.height,n=new createjs.Shape;n.graphics.beginFill("#ffffff").drawRect(-r/2,-q/2,r,q);k.addChild(n);m=createBitmap(m);m.regX=r/2;m.regY=q/2;k.addChild(m);n=new createjs.Shape;n.graphics.beginStroke("#000000").setStrokeStyle(10).drawRect(-r/2,-q/2,r,q);k.addChild(n);v=new createjs.Container;
v.x=CANVAS_WIDTH/2;v.y=CANVAS_HEIGHT/2-190;v.scaleX=.3;v.scaleY=.3;v.cursor="pointer";v.on("click",this._onImageClicked,this,!1,"image2");m=s_oSpriteLibrary.getSprite("image2");r=m.width;q=m.height;n=new createjs.Shape;n.graphics.beginFill("#ffffff").drawRect(-r/2,-q/2,r,q);v.addChild(n);m=createBitmap(m);m.regX=r/2;m.regY=q/2;v.addChild(m);n=new createjs.Shape;n.graphics.beginStroke("#000000").setStrokeStyle(10).drawRect(-r/2,-q/2,r,q);v.addChild(n);u=new createjs.Container;u.x=CANVAS_WIDTH/2+500;
u.y=CANVAS_HEIGHT/2-190;u.scaleX=.3;u.scaleY=.3;u.cursor="pointer";u.on("click",this._onImageClicked,this,!1,"image3");m=s_oSpriteLibrary.getSprite("image3");r=m.width;q=m.height;n=new createjs.Shape;n.graphics.beginFill("#ffffff").drawRect(-r/2,-q/2,r,q);u.addChild(n);m=createBitmap(m);m.regX=r/2;m.regY=q/2;u.addChild(m);n=new createjs.Shape;n.graphics.beginStroke("#000000").setStrokeStyle(10).drawRect(-r/2,-q/2,r,q);u.addChild(n);w=new createjs.Container;w.x=CANVAS_WIDTH/2-500;w.y=CANVAS_HEIGHT/
2+230;w.scaleX=.3;w.scaleY=.3;w.cursor="pointer";w.on("click",this._onImageClicked,this,!1,"image4");m=s_oSpriteLibrary.getSprite("image4");r=m.width;q=m.height;n=new createjs.Shape;n.graphics.beginFill("#ffffff").drawRect(-r/2,-q/2,r,q);w.addChild(n);m=createBitmap(m);m.regX=r/2;m.regY=q/2;w.addChild(m);n=new createjs.Shape;n.graphics.beginStroke("#000000").setStrokeStyle(10).drawRect(-r/2,-q/2,r,q);w.addChild(n);l=new createjs.Container;l.x=CANVAS_WIDTH/2;l.y=CANVAS_HEIGHT/2+230;l.scaleX=.3;l.scaleY=
.3;l.cursor="pointer";l.on("click",this._onImageClicked,this,!1,"image5");m=s_oSpriteLibrary.getSprite("image5");r=m.width;q=m.height;n=new createjs.Shape;n.graphics.beginFill("#ffffff").drawRect(-r/2,-q/2,r,q);l.addChild(n);m=createBitmap(m);m.regX=r/2;m.regY=q/2;l.addChild(m);n=new createjs.Shape;n.graphics.beginStroke("#000000").setStrokeStyle(10).drawRect(-r/2,-q/2,r,q);l.addChild(n);x=new createjs.Container;x.x=CANVAS_WIDTH/2+500;x.y=CANVAS_HEIGHT/2+230;x.scaleX=.3;x.scaleY=.3;x.cursor="pointer";
x.on("click",this._onImageClicked,this,!1,"image6");m=s_oSpriteLibrary.getSprite("image6");r=m.width;q=m.height;n=new createjs.Shape;n.graphics.beginFill("#ffffff").drawRect(-r/2,-q/2,r,q);x.addChild(n);m=createBitmap(m);m.regX=r/2;m.regY=q/2;x.addChild(m);n=new createjs.Shape;n.graphics.beginStroke("#000000").setStrokeStyle(10).drawRect(-r/2,-q/2,r,q);x.addChild(n);s_oInteractiveStage.addChild(e,g,f,k,v,u,w,l,x);if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)m=s_oSpriteLibrary.getSprite("audio_icon"),
c=CANVAS_WIDTH-m.height/2-10,d=m.height/2+10,h=new CToggle(c,d,m,s_bAudioActive),h.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this);r=window.document;q=r.documentElement;y=q.requestFullscreen||q.mozRequestFullScreen||q.webkitRequestFullScreen||q.msRequestFullscreen;A=r.exitFullscreen||r.mozCancelFullScreen||r.webkitExitFullscreen||r.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(y=!1);m=s_oSpriteLibrary.getSprite("but_fullscreen");!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(a=c-m.width/2-10,b=m.height/
2+10):(a=CANVAS_WIDTH-m.height/2-10,b=m.height/2+10);y&&screenfull.enabled&&(p=new CToggle(a,b,m,s_bFullscreen,s_oStage),p.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this));this.refreshButtonPos(s_iOffsetX,s_iOffsetY)};this.unload=function(){if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)h.unload(),h=null;y&&screenfull.enabled&&p.unload();s_oInteractiveStage.removeAllChildren();k.off("click",this._onImageClicked,this,!1,"image1");v.off("click",this._onImageClicked,this,!1,"image2");u.off("click",
this._onImageClicked,this,!1,"image3");w.off("click",this._onImageClicked,this,!1,"image4");l.off("click",this._onImageClicked,this,!1,"image5");l.off("click",this._onImageClicked,this,!1,"image6");s_oModeMenu=null;s_oInteractiveStage.update()};this.refreshButtonPos=function(e,f){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||h.setPosition(c-e,f+d);y&&screenfull.enabled&&p.setPosition(a-e,b+f);s_oInteractiveStage.update()};this.resetFullscreenBut=function(){y&&screenfull.enabled&&p.setActive(s_bFullscreen)};
this._onFullscreenRelease=function(){s_bFullscreen?A.call(window.document):y.call(window.document.documentElement);sizeHandler()};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this._onImageClicked=function(a,b){this.unload();$(s_oMain).trigger("start_level",1);s_oMain.gotoGame(b);playSound("click",1,!1)};s_oModeMenu=this;this._init()}var s_oModeMenu=null;
function CGame(a){var b,c,d,e,f,g,h,p,k,v,u,w,l,x,y,A,m,r,q,n,z,C=s_oDrawStage.canvas.getContext("2d");this._init=function(){h=10;f=null;v=0;w=createBitmap(s_oSpriteLibrary.getSprite("bg_game"));s_oDrawStage.addChild(w);A=new createjs.Container;A.x=CANVAS_WIDTH/2;A.y=CANVAS_HEIGHT/2;s_oDrawStage.addChild(A);var a=s_oSpriteLibrary.getSprite("canvas_drawing");p=a.width;k=a.height;x=createBitmap(a);A.addChild(x);A.regX=p/2;A.regY=k/2;b=CANVAS_WIDTH/2-p/2+.5*h;c=CANVAS_HEIGHT/2-k/2+.5*h;d=p+CANVAS_WIDTH/
2-p/2-.5*h;e=k+CANVAS_HEIGHT/2-k/2-.5*h;l=new createjs.Shape;l.graphics.setStrokeStyle(h,"round","round");r=new createjs.Container;s_oStage.addChild(r);a=s_oSpriteLibrary.getSprite(s_szCurDraw);m=createBitmap(a);m.x=CANVAS_WIDTH/2;m.y=CANVAS_HEIGHT/2;m.regX=a.width/2;m.regY=a.height/2;s_oInteractiveStage.addChild(m);r.addChild(l);a=s_oSpriteLibrary.getSprite("drawcanvas_frame");y=createBitmap(a);y.x=CANVAS_WIDTH/2;y.y=CANVAS_HEIGHT/2;y.regX=a.width/2;y.regY=a.height/2;s_oInteractiveStage.addChild(y);
n=new createjs.Text(TEXT_HELP1," 60px "+PRIMARY_FONT,"#eedc20");n.x=CANVAS_WIDTH/2;n.y=CANVAS_HEIGHT/2;n.textAlign="center";n.textBaseline="alphabetic";n.lineWidth=800;n.visible=!1;z=new createjs.Text(TEXT_HELP1," 60px "+PRIMARY_FONT,"#ff4200");z.x=CANVAS_WIDTH/2;z.y=CANVAS_HEIGHT/2;z.textAlign="center";z.textBaseline="alphabetic";z.lineWidth=800;z.outline=10;z.visible=!1;s_oInteractiveStage.addChild(z,n);q=new createjs.Shape;q.graphics.beginFill("rgba(255,255,255,0.01)").drawRect(-580,-410,1160,
820);q.x=CANVAS_WIDTH/2;q.y=CANVAS_HEIGHT/2;q.on("mousedown",this._setAdvice);s_oInteractiveStage.addChild(q);s_bMobile?(window.navigator.msPointerEnabled&&(_iContTouchMS=0),s_oInteractiveStage.addEventListener("stagemousedown",this.onMouseStart,!1),s_oInteractiveStage.addEventListener("stagemouseup",this.onMouseEnd,!1)):(s_oInteractiveStage.addEventListener("stagemousedown",this.onMouseStart),s_oInteractiveStage.addEventListener("stagemouseup",this.onMouseEnd));u=new CInterface;s_oDrawStage.update();
s_oInteractiveStage.update()};this.printImg=function(){var a=s_oSpriteLibrary.getSprite(s_szCurDraw);s_oSpriteLibrary.getSprite(s_szCurDraw);var b=createBitmap(a);b.x=CANVAS_WIDTH/2;b.y=CANVAS_HEIGHT/2;b.regX=a.width/2;b.regY=a.height/2;m.visible=!1;s_oDrawStage.addChild(b);w.visible=!1;s_oDrawStage.update();a="<!DOCTYPE html><html>"+('<img src="'+document.getElementById("draw_canvas").toDataURL()+'">')+"</html>";var c=window.open("","","width=1920,height=1080");c.document.open();c.document.write(a);
c.document.close();c.focus();c.print();c.close();s_oDrawStage.removeChild(b);m.visible=!0;w.visible=!0;s_oDrawStage.update()};this.saveImg=function(){var a=s_oSpriteLibrary.getSprite(s_szCurDraw);s_oSpriteLibrary.getSprite(s_szCurDraw);var b=createBitmap(a);b.x=CANVAS_WIDTH/2;b.y=CANVAS_HEIGHT/2;b.regX=a.width/2;b.regY=a.height/2;m.visible=!1;s_oDrawStage.addChild(b);w.visible=!1;s_oDrawStage.update();a=document.createElement("a");document.body.appendChild(a);var c=s_szCurDraw+pad(Math.round(1E3*
Math.random()),4)+".png";a.download=c;a.href=s_oDrawCanvas.toDataURL("image/png");a.click();s_oDrawStage.removeChild(b);m.visible=!0;w.visible=!0;s_oDrawStage.update()};this.sliderMoving=function(a){};this.tryShowAd=function(){v++;v===AD_SHOW_COUNTER&&(v=0,$(s_oMain).trigger("show_interlevel_ad"))};this.setColor=function(a){f=a;this.tryShowAd()};this.getColor=function(){return f};this.saveTempColor=function(){g=f};this.setTempColor=function(){f=g};this.getTempColor=function(){return g};this.setStroke=
function(a){h=a;b=CANVAS_WIDTH/2-p/2+.5*h;c=CANVAS_HEIGHT/2-k/2+.5*h;d=p+CANVAS_WIDTH/2-p/2-.5*h;e=k+CANVAS_HEIGHT/2-k/2-.5*h};this.deleteStroke=function(a){f=a?"#ffffff":null};this.initStroke=function(){l=new createjs.Shape;l.graphics.setStrokeStyle(h,"round","round");l.graphics.beginStroke(f);r.addChild(l)};this.onMouseStart=function(a){a=a||window.event;!a.primary||s_oInteractiveStage.mouseX<b||s_oInteractiveStage.mouseX>d||s_oInteractiveStage.mouseY<c||s_oInteractiveStage.mouseY>e||(s_oGame.initStroke(),
l.graphics.moveTo(s_oInteractiveStage.mouseX,s_oInteractiveStage.mouseY),s_oInteractiveStage.addEventListener("stagemousemove",B.onMouseMove))};this.onMouseMove=function(a){!a.primary||s_oInteractiveStage.mouseX<b||s_oInteractiveStage.mouseX>d||s_oInteractiveStage.mouseY<c||s_oInteractiveStage.mouseY>e||(l.graphics.lineTo(s_oInteractiveStage.mouseX,s_oInteractiveStage.mouseY),checkIfiOS()?l.draw(C):s_oStage.update())};this.onMouseEnd=function(a){a.primary&&(s_oDrawStage.addChild(l),l.graphics.endStroke(),
r.removeChild(l),s_oDrawStage.update(),s_oStage.update(),s_oInteractiveStage.removeEventListener("stagemousemove",B.onMouseMove))};this.restartGame=function(){s_oDrawStage.removeAllChildren();l.graphics.clear();s_oDrawStage.addChild(w);s_oDrawStage.addChild(A);var a=s_oSpriteLibrary.getSprite("canvas_drawing");p=a.width;k=a.height;x=createBitmap(a);A.addChild(x);s_oDrawStage.update();s_oStage.update()};this.unload=function(){u.unload();q.off("mousedown",this._setAdvice);createjs.Tween.removeAllTweens();
s_oStage.removeAllChildren();s_oStage.update()};this.onExit=function(){this.unload();s_oMain.gotoMenu()};this._setAdvice=function(){null!==f||u.getSliderVisible()||B.colorAdvice(!0)};this.colorAdvice=function(a){n.visible=a;z.visible=a;s_oInteractiveStage.update()};this.update=function(){};s_oGame=this;COLORS=a.colors;MIN_STROKE=a.min_stroke_size;MAX_STROKE=a.max_stroke_size;AD_SHOW_COUNTER=a.ad_show_counter;var B=this;this._init()}var s_oGame;
function CInterface(){var a,b,c,d,e,f,g,h,p,k,v,u,w,l,x,y,A,m,r,q,n=null,z,C,B,E,F,D=null,G=null;this._init=function(){l=w=null;var t=s_oSpriteLibrary.getSprite("but_exit");v=CANVAS_WIDTH-t.height/2-20;u=t.height/2+10;A=new CGfxButton(v,u,t,!0);A.addEventListener(ON_MOUSE_UP,this._onExit,this);p=CANVAS_WIDTH-t.width/2-20;k=250;if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)t=s_oSpriteLibrary.getSprite("audio_icon"),y=new CToggle(p,k,t,s_bAudioActive),y.addEventListener(ON_MOUSE_UP,this._onAudioToggle,
this);t=window.document;var n=t.documentElement;D=n.requestFullscreen||n.mozRequestFullScreen||n.webkitRequestFullScreen||n.msRequestFullscreen;G=t.exitFullscreen||t.mozCancelFullScreen||t.webkitExitFullscreen||t.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(D=!1);t=s_oSpriteLibrary.getSprite("but_fullscreen");!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(a=p,b=k+t.width/2+10):(a=CANVAS_WIDTH-t.width/4-20,b=250);D&&screenfull.enabled&&(F=new CToggle(a,b,t,s_bFullscreen,s_oStage),F.addEventListener(ON_MOUSE_UP,
this._onFullscreenRelease,this));t=s_oSpriteLibrary.getSprite("but_save");g=t.height/2+20;h=t.height/2+10;m=new CGfxButton(g,h,t,!0);m.addEventListener(ON_MOUSE_UP,this._onSaveAsImg,this);t=s_oSpriteLibrary.getSprite("but_print");e=t.height/2+20;f=250;r=new CGfxButton(e,f,t,!0);r.addEventListener(ON_MOUSE_UP,this._onPrinteAsImg,this);t=s_oSpriteLibrary.getSprite("but_restart");c=t.height/2+20;d=415;q=new CGfxButton(c,d,t,!0);q.addEventListener(ON_MOUSE_UP,this._onButRestartRelease,this);z=new createjs.Container;
t=1E3-EDGEBOARD_Y;z.x=CANVAS_WIDTH/2;z.y=t;x=[];for(t=0;t<COLORS.length;t++)x[t]=new CPen(50*t,0,COLORS[t],t,z);s_oInteractiveStage.addChild(z);x[COLORS.length]=new CPen(-100,0,"eraser",COLORS.length,z);C=new createjs.Container;C.x=1600;C.y=1E3;s_oInteractiveStage.addChild(C);t=s_oSpriteLibrary.getSprite("slider");B=new CSlider(0,-125,t,MIN_STROKE,MAX_STROKE,C);t=s_oSpriteLibrary.getSprite("sliderbox");E=new CSliderBox(0,0,t,C);t=B.getValue();this.setStroke(t);t=z.getBounds();z.regX=(t.width-100)/
2;this.refreshButtonPos(s_iOffsetX,s_iOffsetY);s_oInteractiveStage.update()};this.unload=function(){if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)y.unload(),y=null;for(var a=0;a<x.length;a++)x[a].unload();D&&screenfull.enabled&&F.unload();A.unload();m.unload();r.unload();q.unload();B.unload();E.unload();s_oInterface=null};this.disableStroke=function(){s_oGame.deleteStroke(!1)};this.restartStroke=function(){s_oGame.setColor(w)};this.setStroke=function(a){s_oGame.setStroke(a)};this.getStroke=function(){return B.getValue()};
this.setActivePen=function(a,b){this.setSliderVisible(!1);s_oGame.setColor(a);s_oGame.colorAdvice(!1);w=a;E.setActive(!1);null!==l&&x[l].setActive(!1);l=b};this.getCircleSize=function(){return B.getValue()};this.setCircleImage=function(a,b){E.setCircle(a,b)};this.setSliderVisible=function(a){B.setVisible(a);E.setSliderVisible(a);a||E.setActive(!1)};this.getSliderVisible=function(){return B.getVisible()};this._onSaveAsImg=function(){s_oGame.saveImg()};this._onPrinteAsImg=function(){s_oGame.printImg()};
this.refreshButtonPos=function(l,n){A.setPosition(v-l,n+u);!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||y.setPosition(p-l,n+k);m.setPosition(g+l,n+h);r.setPosition(e+l,n+f);q.setPosition(c+l,n+d);D&&screenfull.enabled&&F.setPosition(a-l,b+n);s_oInteractiveStage.update()};this._onButHelpRelease=function(){n=new CHelpPanel};this._onButRestartRelease=function(){$(s_oMain).trigger("restart_level",1);$(s_oMain).trigger("show_interlevel_ad");s_oGame.restartGame()};this.onExitFromHelp=function(){n.unload()};
this.resetFullscreenBut=function(){D&&screenfull.enabled&&F.setActive(s_bFullscreen)};this._onFullscreenRelease=function(){s_bFullscreen?G.call(window.document):D.call(window.document.documentElement);sizeHandler()};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this._onExit=function(){$(s_oMain).trigger("end_level",1);$(s_oMain).trigger("end_session");$(s_oMain).trigger("show_interlevel_ad");s_oGame.onExit()};s_oInterface=this;this._init();return this}
var s_oInterface=null;
function CPen(a,b,c,d,e){var f,g,h,p;this._init=function(a,b,c,d,e){f=50;g=d;p=e;"eraser"===c?(d=s_oSpriteLibrary.getSprite("eraser"),h=createBitmap(d),h.x=a,h.y=b,h.cache(0,0,100,200),h.on("mousedown",this._setEraser)):(d=s_oSpriteLibrary.getSprite("pen"),h=createBitmap(d),h.x=a,h.y=b,a=hexToRgb(c).r,b=hexToRgb(c).g,c=hexToRgb(c).b,c=new createjs.ColorFilter(a/255,b/255,c/255,1),h.filters=[c],h.cache(0,0,50,200),h.on("mousedown",this._setColor));h.cursor="pointer";p.addChild(h)};this.unload=function(){h.off("mousedown",
this._setColor);p.removeChild(h)};this._setColor=function(){playSound("click",1,!1);s_oInterface.setActivePen(c,g);k.setActive(!0)};this._setEraser=function(){playSound("click",1,!1);s_oInterface.setActivePen("#FFFFFF",g);k.setActive(!0)};this.setActive=function(a){h.y=a?b-f:b;h.updateCache();s_oInterface.setCircleImage(s_oInterface.getCircleSize(),s_oGame.getColor());s_oInteractiveStage.update()};var k=this;this._init(a,b,c,d,e)}
function CCreditsPanel(){var a,b,c,d;this._init=function(){a=new createjs.Shape;a.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);a.alpha=.7;a.on("mousedown",function(){});s_oInteractiveStage.addChild(a);b=new createjs.Container;s_oInteractiveStage.addChild(b);var e=s_oSpriteLibrary.getSprite("msg_box"),f=createBitmap(e);f.regX=e.width/2;f.regY=e.height/2;b.addChild(f);b.x=CANVAS_WIDTH/2;b.y=CANVAS_HEIGHT/2;f=new createjs.Text("Have fun with"," 40px "+PRIMARY_FONT,"#008df0");f.y=
-e.height/2+180;f.textAlign="center";f.textBaseline="middle";f.lineWidth=400;b.addChild(f);e=new createjs.Text("...and Kobe"," 40px "+PRIMARY_FONT,"#008df0");e.y=90;e.textAlign="center";e.textBaseline="middle";e.lineWidth=400;b.addChild(e);e=s_oSpriteLibrary.getSprite("ctl_logo");d=createBitmap(e);d.on("mousedown",this._onLogoButRelease);d.regX=e.width/2;d.regY=e.height/2;b.addChild(d);e=s_oSpriteLibrary.getSprite("but_exit");c=new CGfxButton(1320,330,e,b);c.addEventListener(ON_MOUSE_UP,this.unload,
this)};this.unload=function(){s_oInteractiveStage.removeChild(a);s_oInteractiveStage.removeChild(b);c.unload();a.off("mousedown",function(){});d.off("mousedown",this._onLogoButRelease)};this._onLogoButRelease=function(){window.open("http://www.codethislab.com/index.php?&l=en")};this._onMoreGamesReleased=function(){window.open("http://codecanyon.net/collections/5409142-games")};this._init()};
